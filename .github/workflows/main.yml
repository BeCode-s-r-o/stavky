on:
  push:
    branches:
      - main
  pull_request:
    types:
      - closed
name: CI/CD Pipeline 🛠
jobs:
  web-deploy:
    name: 🚀 Nahrať na FTP server
    runs-on: ubuntu-latest
    steps:
      - name: 📥 Stiahnuť repozitár
        uses: actions/checkout@v2

      - name: Použiť Node.js 14
        uses: actions/setup-node@v2
        with:
          node-version: '14'

      - name: 📦 Nainštalovať NPM balíčky
        run: npm install --force

      - name: 🛠 Zbaliť Forex projekt
        run: npm run build:forex

      - name: 📤 Nahrať na FTP server
        uses: SamKirkland/FTP-Deploy-Action@4.3.2
        with:
          server: forexporadenstvo.sk
          username: ftp.forexporadenstvo.sk
          password: ${{secrets.FTP_PASSWORD_FOREX}}
          local-dir: ./build/
          server-dir: forexporadenstvo.sk/web/
          log-level: verbose
          port: 21
          protocol: ftp
          timeout: 100000

      - name: 🛠 Zbaliť Stávky projekt
        run: npm run build:stavkove

      - name: 📤 Nahrať na FTP server
        uses: SamKirkland/FTP-Deploy-Action@4.3.2
        with:
          server: stavkoveporadenstvo.sk
          username: ftp.stavkoveporadenstvo.sk
          password: ${{secrets.FTP_PASSWORD_STAVKY}}
          local-dir: ./build/
          server-dir: stavkoveporadenstvo.sk/web/
          log-level: verbose
          port: 21
          protocol: ftp
          timeout: 100000
